<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="ndf-parse" href="ndf-parse.html" /><link rel="prev" title="Overview" href="overview.html" />

    <link rel="shortcut icon" href="_static/favicon.png"/><!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>Documentation - ndf-parse 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=c8f71b31" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #fdf6e3;
  --color-code-foreground: #657b83;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #0d1117;
  --color-code-foreground: #e6edf3;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #0d1117;
  --color-code-foreground: #e6edf3;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">ndf-parse 0.2.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/ndf_parse_logo_blob.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/ndf_parse_logo.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">ndf-parse 0.2.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Documentation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="ndf-parse.html">ndf-parse (API Reference)</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of ndf-parse (API Reference)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="ndf-parse/model.html">model</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of model</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="ndf-parse/model/abc.html">abc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ndf-parse/printer.html">printer</a></li>
</ul>
</li>
</ul>

</div></div>
<div class="sidebar-tree">
  <p><span class="caption-text">Versions</span></p>
  <ul>
      <li class="toctree-l1"><a style="padding-left:1rem" href="docs.html">
        v0.2.0 <b>latest</b>
    </a></li>
      <li class="toctree-l1"><a style="padding-left:1rem" href="../v0.1.2/index.html">
        v0.1.2
    </a></li>
  </ul>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="documentation">
<h1>Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading">#</a></h1>
<p>This documentation starts with a <a class="reference internal" href="#quick-start"><span class="std std-ref">quickstart</span></a> section with a
code showing main features of the library. The code gets explained below in 4
following secitons all tied up to the quickstart and showing alternative methods
to form an overall understanding of how this tool works:</p>
<ol class="arabic simple">
<li><p>Setting up the mod.</p></li>
<li><p>Searching and comparing things.</p></li>
<li><p>Editing things.</p></li>
<li><p>Creating/deleting things.</p></li>
</ol>
<p>If you struggle to understand how ndf entities are represented in the model then
<a class="reference internal" href="ndf-parse/model.html#model-representation"><span class="std std-ref">read this primer on the model relations</span></a>.</p>
<section id="quick-start">
<span id="id1"></span><h2>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this heading">#</a></h2>
<section id="before-we-begin">
<h3>Before We Begin<a class="headerlink" href="#before-we-begin" title="Permalink to this heading">#</a></h3>
<p>First thing we need to do is to set up a pristine copy of the mod sources. This
module works in the following way:</p>
<ol class="arabic simple">
<li><p>Get a file from an unchanged mod (we’ll refer to it as a <em>source mod</em>).</p></li>
<li><p>Parse, convert to model representation.</p></li>
<li><p>Apply our edits.</p></li>
<li><p>Format back to ndf and write it to a directory with our final mod (we’ll
refer to it as a <em>destination mod</em>).</p></li>
</ol>
<p>Generate a new source mod using <code class="docutils literal notranslate"><span class="pre">CreateNewMod.bat</span></code> provided by Eugen Systems
and place it to <code class="docutils literal notranslate"><span class="pre">path/to/src/mod</span></code>.</p>
</section>
<section id="make-the-script">
<h3>Make The Script<a class="headerlink" href="#make-the-script" title="Permalink to this heading">#</a></h3>
<p>We are going to make a mod that adds a <code class="code highlight py docutils literal highlight-py"><span class="s1">&#39;HE&#39;</span></code> trait to all
autocannons, then we are going to add 2 new weapon types. Not the most useful
mod but it is enough to demonstrate the basic workflow.</p>
<p>Create a new python file, say, <code class="docutils literal notranslate"><span class="pre">my_mod.py</span></code> with the following code:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">quick_start.py</span><a class="headerlink" href="#id8" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1"># change PATH_TO_SRC_MOD and PATH_TO_DEST_MOD to actual paths, like this:</span>
<span class="linenos"> 4</span><span class="c1"># ndf.Mod(r&quot;C:\game\mods\src_mod&quot;, r&quot;C:\game\mods\dest_mod&quot;)</span>
<span class="linenos"> 5</span><span class="c1"># `src_mod` must be a root folder of the source mod, i.e. the one where</span>
<span class="linenos"> 6</span><span class="c1"># folders CommonData and GameData reside.</span>
<span class="linenos"> 7</span><span class="n">mod</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">Mod</span><span class="p">(</span><span class="n">PATH_TO_SRC_MOD</span><span class="p">,</span> <span class="n">PATH_TO_DEST_MOD</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="n">mod</span><span class="o">.</span><span class="n">check_if_src_is_newer</span><span class="p">()</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="k">with</span> <span class="n">mod</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;GameData\Generated\Gameplay\Gfx\Ammunition.ndf&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">source</span><span class="p">:</span>
<span class="linenos">11</span>    <span class="c1"># let&#39;s find all automatic cannons and edit them a bit</span>
<span class="linenos">12</span>    <span class="c1"># quotes in pattern must match source!     v          v</span>
<span class="linenos">13</span>    <span class="n">pattern</span> <span class="o">=</span> <span class="s2">&quot;TAmmunitionDescriptor(Caliber = &#39;DYDXERZARY&#39;)&quot;</span>
<span class="linenos">14</span>    <span class="k">for</span> <span class="n">obj_row</span> <span class="ow">in</span> <span class="n">source</span><span class="o">.</span><span class="n">match_pattern</span><span class="p">(</span><span class="n">pattern</span><span class="p">):</span>
<span class="linenos">15</span>        <span class="c1"># each time we get here it means that we&#39;ve got ammunition of matching caliber</span>
<span class="linenos">16</span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing </span><span class="si">{</span><span class="n">obj_row</span><span class="o">.</span><span class="n">namespace</span><span class="si">}</span><span class="s2">... &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos">17</span>        <span class="n">traits_row</span> <span class="o">=</span> <span class="n">obj_row</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">by_member</span><span class="p">(</span><span class="s2">&quot;TraitsToken&quot;</span><span class="p">)</span>
<span class="linenos">18</span>        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;&#39;HE&#39;&quot;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">traits_row</span><span class="o">.</span><span class="n">v</span><span class="p">):</span>
<span class="linenos">19</span>            <span class="c1"># skip this ammo if it already has a given trait</span>
<span class="linenos">20</span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    already has &#39;HE&#39; trait, skipping.&quot;</span><span class="p">)</span>
<span class="linenos">21</span>            <span class="k">continue</span>  <span class="c1"># note: this means &quot;skip code below and CONTINUE to the next loop</span>
<span class="linenos">22</span>                      <span class="c1"># iteration&quot;, NOT &quot;continue execution below&quot;</span>
<span class="linenos">23</span>        <span class="c1"># 30mm that has no HE, let&#39;s fix that</span>
<span class="linenos">24</span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    adding &#39;HE&#39; trait.&quot;</span><span class="p">)</span>
<span class="linenos">25</span>        <span class="n">traits_row</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;&#39;HE&#39;&quot;</span><span class="p">)</span>  <span class="c1"># this will get converted under the hood</span>
<span class="linenos">26</span>                                        <span class="c1"># into a row with value &#39;HE&#39;</span>
<span class="linenos">27</span>
<span class="linenos">28</span>    <span class="c1"># now let&#39;s add 2 new types of ammo</span>
<span class="linenos">29</span>    <span class="n">EDITS</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">30</span>        <span class="p">{</span>
<span class="linenos">31</span>            <span class="s2">&quot;donor&quot;</span><span class="p">:</span> <span class="s2">&quot;Ammo_AutoCanon_AP_30mm_24A2&quot;</span><span class="p">,</span>
<span class="linenos">32</span>            <span class="s2">&quot;new_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Ammo_BFG_30mm&quot;</span><span class="p">,</span>
<span class="linenos">33</span>            <span class="s2">&quot;guid&quot;</span><span class="p">:</span> <span class="s2">&quot;GUID:{6b41aa60-9fd7-4c47-8614-c7b6e8009ef3}&quot;</span><span class="p">,</span>
<span class="linenos">34</span>            <span class="s2">&quot;dispers_min&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
<span class="linenos">35</span>            <span class="s2">&quot;dispers_max&quot;</span><span class="p">:</span> <span class="s2">&quot;Metre&quot;</span><span class="p">,</span>
<span class="linenos">36</span>            <span class="s2">&quot;damage&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0&quot;</span><span class="p">,</span>
<span class="linenos">37</span>        <span class="p">},</span>
<span class="linenos">38</span>        <span class="p">{</span>
<span class="linenos">39</span>            <span class="s2">&quot;donor&quot;</span><span class="p">:</span> <span class="s2">&quot;Ammo_GatlingAir_ADEN_Mk4_30mm_x2&quot;</span><span class="p">,</span>
<span class="linenos">40</span>            <span class="s2">&quot;new_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Ammo_ImDrunk_30mm&quot;</span><span class="p">,</span>
<span class="linenos">41</span>            <span class="s2">&quot;guid&quot;</span><span class="p">:</span> <span class="s2">&quot;GUID:{1e285336-37e9-41c1-9b67-2bab21271bfc}&quot;</span><span class="p">,</span>
<span class="linenos">42</span>            <span class="s2">&quot;dispers_min&quot;</span><span class="p">:</span> <span class="s2">&quot;((500) * Metre)&quot;</span><span class="p">,</span>
<span class="linenos">43</span>            <span class="s2">&quot;dispers_max&quot;</span><span class="p">:</span> <span class="s2">&quot;((1000) * Metre)&quot;</span><span class="p">,</span>
<span class="linenos">44</span>            <span class="s2">&quot;damage&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span><span class="p">,</span>
<span class="linenos">45</span>        <span class="p">},</span>
<span class="linenos">46</span>    <span class="p">]</span>
<span class="linenos">47</span>
<span class="linenos">48</span>    <span class="k">for</span> <span class="n">edit</span> <span class="ow">in</span> <span class="n">EDITS</span><span class="p">:</span>
<span class="linenos">49</span>        <span class="c1"># grab a copy of a row that matches out needs the most</span>
<span class="linenos">50</span>        <span class="n">gun_donor_row</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">by_namespace</span><span class="p">(</span><span class="n">edit</span><span class="p">[</span><span class="s2">&quot;donor&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="linenos">51</span>        <span class="c1"># rename it</span>
<span class="linenos">52</span>        <span class="n">gun_donor_row</span><span class="o">.</span><span class="n">namespace</span> <span class="o">=</span> <span class="n">edit</span><span class="p">[</span><span class="s2">&quot;new_name&quot;</span><span class="p">]</span>
<span class="linenos">53</span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Building </span><span class="si">{</span><span class="n">gun_donor_row</span><span class="o">.</span><span class="n">namespace</span><span class="si">}</span><span class="s2">... &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos">54</span>        <span class="c1"># apply edits member rows of the ammo data</span>
<span class="linenos">55</span>        <span class="n">ammo</span> <span class="o">=</span> <span class="n">gun_donor_row</span><span class="o">.</span><span class="n">v</span>
<span class="linenos">56</span>        <span class="n">ammo</span><span class="o">.</span><span class="n">by_member</span><span class="p">(</span><span class="s2">&quot;DescriptorId&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">edit</span><span class="p">[</span><span class="s2">&quot;guid&quot;</span><span class="p">]</span>
<span class="linenos">57</span>        <span class="n">ammo</span><span class="o">.</span><span class="n">by_member</span><span class="p">(</span><span class="s2">&quot;DispersionAtMinRange&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">edit</span><span class="p">[</span><span class="s2">&quot;dispers_min&quot;</span><span class="p">]</span>
<span class="linenos">58</span>        <span class="n">ammo</span><span class="o">.</span><span class="n">by_member</span><span class="p">(</span><span class="s2">&quot;DispersionAtMaxRange&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">edit</span><span class="p">[</span><span class="s2">&quot;dispers_max&quot;</span><span class="p">]</span>
<span class="linenos">59</span>        <span class="n">ammo</span><span class="o">.</span><span class="n">by_member</span><span class="p">(</span><span class="s2">&quot;DescriptorId&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">edit</span><span class="p">[</span><span class="s2">&quot;guid&quot;</span><span class="p">]</span>
<span class="linenos">60</span>        <span class="n">ammo</span><span class="o">.</span><span class="n">by_member</span><span class="p">(</span><span class="s2">&quot;PhysicalDamages&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">edit</span><span class="p">[</span><span class="s2">&quot;damage&quot;</span><span class="p">]</span>
<span class="linenos">61</span>        <span class="c1"># add new ammo descriptor to the source file</span>
<span class="linenos">62</span>        <span class="n">source</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gun_donor_row</span><span class="p">)</span>
<span class="linenos">63</span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;added with an index of </span><span class="si">{</span><span class="n">gun_donor_row</span><span class="o">.</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">64</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DONE!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Run this script (but don’t forget to substitute your mod paths first!) You
should see prints that correspond to operations from this sctipt. Now, if you
navigate to your newly generated mod and check <code class="docutils literal notranslate"><span class="pre">Ammunition.ndf</span></code>, you should
find that every autocannon has the <code class="code highlight py docutils literal highlight-py"><span class="s1">&#39;HE&#39;</span></code> trait and at the end of the
file there are 2 new ammo types.</p>
</section>
</section>
<section id="quick-start-explained">
<h2>Quick Start Explained<a class="headerlink" href="#quick-start-explained" title="Permalink to this heading">#</a></h2>
<section id="setting-up">
<h3>Setting Up<a class="headerlink" href="#setting-up" title="Permalink to this heading">#</a></h3>
<p>Now let’s go line by line and examine what this code does.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">7</span><span class="n">mod</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">Mod</span><span class="p">(</span><span class="n">PATH_TO_SRC_MOD</span><span class="p">,</span> <span class="n">PATH_TO_DEST_MOD</span><span class="p">)</span>
<span class="linenos">8</span><span class="n">mod</span><span class="o">.</span><span class="n">check_if_src_is_newer</span><span class="p">()</span>
</pre></div>
</div>
<p>Here we initialize our <a class="reference internal" href="ndf-parse.html#ndf_parse.Mod" title="ndf_parse.Mod"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mod</span></code></a> object. It’s nothing but a convenience
wrapper that saves you time from writing boilerplate code. Second line here
checks if your source mod was updated. Whenever the game gets an update - you
should delete your source mod and regenerate it anew. Next time when you run the
script, that second line detects it (by comparing modification date of source
and destination folders), nukes the destination mod and makes a new fresh copy
of it from the source.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Never store anything important inside of source and destination folders! It
will get nuked by such an update. Store it elsewhere or regenerate it with
your script.</p>
</div>
</section>
<section id="edits">
<h3>Edits<a class="headerlink" href="#edits" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">10</span><span class="k">with</span> <span class="n">mod</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;GameData\Generated\Gameplay\Gfx\Ammunition.ndf&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">source</span><span class="p">:</span>
</pre></div>
</div>
<p><a class="reference internal" href="ndf-parse.html#ndf_parse.Mod.edit" title="ndf_parse.Mod.edit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Mod.edit()</span></code></a> loads the file, parses it, converts to a python representation
(based on <a class="reference internal" href="ndf-parse/model.html"><span class="doc">model</span></a>), stores it internally as an <a class="reference internal" href="ndf-parse.html#ndf_parse.Edit" title="ndf_parse.Edit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edit</span></code></a> and
returns a <a class="reference internal" href="ndf-parse.html#ndf_parse.Mod" title="ndf_parse.Mod"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mod</span></code></a> back. But since <a class="reference internal" href="ndf-parse.html#ndf_parse.Mod" title="ndf_parse.Mod"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mod</span></code></a> is implemented as a context
manager, within <code class="code highlight py docutils literal highlight-py"><span class="k">with</span></code> statement it returns a <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List" title="ndf_parse.model.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.List</span></code></a>
that represents our ndf file and which we can alter. as soon as
<code class="code highlight py docutils literal highlight-py"><span class="k">with</span></code> statement’s scope is closed (i.e. when all of the operations
defined in this block are completed), it will automatically format the
<a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List" title="ndf_parse.model.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a> back to ndf code and write the file out to the destination
mod.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are just tinkering with the code and don’t want to write the file out on
each test run, you can disable it by adding the following argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">10</span><span class="k">with</span> <span class="n">mod</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;GameData\Generated\Gameplay\Gfx\Ammunition.ndf&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">source</span><span class="p">:</span>
</pre></div>
</div>
</div>
<p>You can also manually manage a bunch of edits at the same time. Suppose you want
to rework ammunition for specific decks only. For that you would need at least 4
files: <code class="docutils literal notranslate"><span class="pre">Ammunition.ndf</span></code>, <code class="docutils literal notranslate"><span class="pre">WeaponDescriptor.ndf</span></code>, <code class="docutils literal notranslate"><span class="pre">UniteDescriptor.ndf</span></code> and
<code class="docutils literal notranslate"><span class="pre">Decks.ndf</span></code> of which you will edit only 3 (no edits for Decks). Then you would
do the following:</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">manual_write_control.py</span><a class="headerlink" href="#id9" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="linenos"> 2</span><span class="n">mod</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">Mod</span><span class="p">(</span><span class="s2">&quot;path/to/src/mod&quot;</span><span class="p">,</span> <span class="s2">&quot;path/to/dst/mod&quot;</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="c1"># We don&#39;t want to write out decks because we only use them to query specific</span>
<span class="linenos"> 4</span><span class="c1"># units, so we set `save` argumet to ``False``</span>
<span class="linenos"> 5</span><span class="n">decks_src</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;GameData\Generated\Gameplay\Decks\Decks.ndf&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">current_tree</span>
<span class="linenos"> 6</span><span class="c1"># others we will modify so we leave `save` at default (``True``)</span>
<span class="linenos"> 7</span><span class="n">units_src</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;GameData\Generated\Gameplay\Gfx\UniteDescriptor.ndf&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">current_tree</span>
<span class="linenos"> 8</span><span class="n">weap_src</span>  <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;GameData\Generated\Gameplay\Gfx\WeaponDescriptor.ndf&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">current_tree</span>
<span class="linenos"> 9</span><span class="n">ammo_src</span>  <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;GameData\Generated\Gameplay\Gfx\Ammunition.ndf&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">current_tree</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="o">...</span>  <span class="c1"># here we do all the work with 4 sources</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="k">for</span> <span class="n">edit</span> <span class="ow">in</span> <span class="n">mod</span><span class="o">.</span><span class="n">edits</span><span class="p">:</span>
<span class="linenos">14</span>    <span class="n">mod</span><span class="o">.</span><span class="n">write_edit</span><span class="p">(</span><span class="n">edit</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># ``False`` disables forced writing so it</span>
<span class="linenos">15</span>                                 <span class="c1"># respects `edit.save` attribute</span>
</pre></div>
</div>
</div>
</section>
<section id="navigating-model-instances">
<span id="id2"></span><h3>Navigating model Instances<a class="headerlink" href="#navigating-model-instances" title="Permalink to this heading">#</a></h3>
<p>Next section loops through the root declarations of the file (while matchig the
pattern):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">12</span>    <span class="c1"># quotes in pattern must match source!     v          v</span>
<span class="linenos">13</span>    <span class="n">pattern</span> <span class="o">=</span> <span class="s2">&quot;TAmmunitionDescriptor(Caliber = &#39;DYDXERZARY&#39;)&quot;</span>
<span class="linenos">14</span>    <span class="k">for</span> <span class="n">obj_row</span> <span class="ow">in</span> <span class="n">source</span><span class="o">.</span><span class="n">match_pattern</span><span class="p">(</span><span class="n">pattern</span><span class="p">):</span>
</pre></div>
</div>
<p>All classes that are subclasses of <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List" title="ndf_parse.model.abc.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.abc.List</span></code></a> (I call them
“list-likes”) are iterable as well as have length (<code class="docutils literal notranslate"><span class="pre">len(source)</span></code>). This means
that you can iterate through <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List" title="ndf_parse.model.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.List</span></code></a>, <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Object" title="ndf_parse.model.Object"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.Object</span></code></a> ,
<a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Template" title="ndf_parse.model.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.Template</span></code></a> and <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Map" title="ndf_parse.model.Map"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.Map</span></code></a>. Stray pairs (ones that are not
inside of a Map) are defined as a <a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#tuple" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>. Everything else is essentially
a string literal. This also means that <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List" title="ndf_parse.model.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>,
<a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Object" title="ndf_parse.model.Object"><code class="xref py py-class docutils literal notranslate"><span class="pre">Object</span></code></a> , <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Template" title="ndf_parse.model.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">Template</span></code></a> and <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Map" title="ndf_parse.model.Map"><code class="xref py py-class docutils literal notranslate"><span class="pre">Map</span></code></a> all
have a <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.parent" title="ndf_parse.model.abc.List.parent"><code class="xref py py-attr docutils literal notranslate"><span class="pre">parent</span></code></a> attribute while others don’t. It’s worth
noting that <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Template" title="ndf_parse.model.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">Template</span></code></a> also has a <code class="xref py py-attr docutils literal notranslate"><span class="pre">params</span></code>
attribute to store it’s generic parameters.</p>
<p>Each returned <code class="docutils literal notranslate"><span class="pre">obj_row</span></code> is a subclass of a <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.Row" title="ndf_parse.model.abc.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.abc.Row</span></code></a> Here is
a correspondence table of all list-likes and their rows:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ndf Code Entities</p></th>
<th class="head"><p>Parent Class</p></th>
<th class="head"><p>Row Class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>root/lists/vector types</p></td>
<td><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List" title="ndf_parse.model.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.List</span></code></a></p></td>
<td><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.ListRow" title="ndf_parse.model.ListRow"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ListRow</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>template parameters</p></td>
<td><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Params" title="ndf_parse.model.Params"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.Params</span></code></a></p></td>
<td><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.ParamRow" title="ndf_parse.model.ParamRow"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.ParamRow</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>templates</p></td>
<td><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Template" title="ndf_parse.model.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.Template</span></code></a></p></td>
<td><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.MemberRow" title="ndf_parse.model.MemberRow"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.MemberRow</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>objects</p></td>
<td><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Object" title="ndf_parse.model.Object"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.Object</span></code></a></p></td>
<td><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.MemberRow" title="ndf_parse.model.MemberRow"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.MemberRow</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>maps</p></td>
<td><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Map" title="ndf_parse.model.Map"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.Map</span></code></a></p></td>
<td><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.MapRow" title="ndf_parse.model.MapRow"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.MapRow</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<p><a class="reference internal" href="ndf-parse/model.html#model-representation"><span class="std std-ref">Here is</span></a> a more detailed representation of how each
model row maps to a corresponding ndf expression.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Rows are built with no referencing in mind. You can reference them in
arbitrary variables or python’s builtin types but anytime you insert them
into model’s lists, they insert a copy instead of self (except for dangling
rows, they insert themselves without doing a copy). This is done to prevent
unexpected edits of the original rows. <a class="reference internal" href="#no-referencing"><span class="std std-ref">More on that here, with
examples.</span></a></p>
</div>
</section>
<section id="search-tools">
<span id="id3"></span><h3>Search Tools<a class="headerlink" href="#search-tools" title="Permalink to this heading">#</a></h3>
<p>Currently there are 4 main ways to search items of interest:</p>
<ol class="arabic">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">model.abc.List.match_pattern</span></code>. Good for
matching items with some shared “trait” in a single list-like (as in the
quickstart code, <a class="reference internal" href="#navigating-model-instances"><span class="std std-ref">lines 12-13</span></a>).</p></li>
<li><p>A recursive <a class="reference internal" href="ndf-parse.html#ndf_parse.walk" title="ndf_parse.walk"><code class="xref py py-func docutils literal notranslate"><span class="pre">walk()</span></code></a>. Good for cases when one needs to walk an entire
subtree (i.e. also search inside children of a list-like) and/or match on a
complex parameter. If we were to reformulate our pattern search with a
walker, it would look like this:</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">quick_start_v2.py</span><a class="headerlink" href="#id10" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">10</span><span class="k">def</span> <span class="nf">is_autocannon</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="linenos">11</span>    <span class="k">return</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ListRow</span><span class="p">)</span>  <span class="c1"># ensure it&#39;s a row,</span>
<span class="linenos">12</span>            <span class="c1"># because `walk` is recursice and compares everything here,</span>
<span class="linenos">13</span>            <span class="c1"># including source itself!</span>
<span class="linenos">14</span>        <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Object</span><span class="p">)</span>  <span class="c1"># ensure there is an</span>
<span class="linenos">15</span>            <span class="c1"># object in this row</span>
<span class="linenos">16</span>        <span class="ow">and</span> <span class="n">row</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;TAmmunitionDescriptor&quot;</span>  <span class="c1"># ensure it&#39;s the</span>
<span class="linenos">17</span>            <span class="c1"># type we need. `type` attr is specific to ObjectRow and</span>
<span class="linenos">18</span>            <span class="c1"># it&#39;s subclasses!</span>
<span class="linenos">19</span>        <span class="ow">and</span> <span class="n">row</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">by_member</span><span class="p">(</span><span class="s2">&quot;Caliber&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;&#39;DYDXERZARY&#39;&quot;</span>  <span class="c1"># ensure it&#39;s a</span>
<span class="linenos">20</span>            <span class="c1"># 30mm autocannon. Note embedded ^  single  ^ quotes!</span>
<span class="linenos">21</span>        <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;&#39;HE&#39;&quot;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">by_member</span><span class="p">(</span><span class="s2">&quot;TraitsToken&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
<span class="linenos">22</span>        <span class="p">)</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="k">with</span> <span class="n">mod</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;GameData\Generated\Gameplay\Gfx\Ammunition.ndf&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">source</span><span class="p">:</span>
<span class="linenos">25</span>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ndf</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">is_autocannon</span><span class="p">):</span>
<span class="linenos">26</span>        <span class="c1"># any row here is a 30mm autocannon with no &#39;HE&#39;, just ad one</span>
<span class="linenos">27</span>        <span class="n">row</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">by_member</span><span class="p">(</span><span class="s2">&quot;TraitsToken&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;&#39;HE&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Cons:</strong> very verbose (all filtering is explicit), processes too many extra
nodes, we call <code class="docutils literal notranslate"><span class="pre">by_member</span></code> a couple times which is a bit costly.</p>
<p><strong>Pros:</strong> allows for very complex filtering, walks entire tree which is
necessary in some cases.</p>
<p>To summarize: a very specific filter for very specific tasks that is good
to have non the less.</p>
</li>
<li><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List.by_namespace" title="ndf_parse.model.List.by_namespace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">by_namespace()</span></code></a>, <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Object.by_member" title="ndf_parse.model.Object.by_member"><code class="xref py py-meth docutils literal notranslate"><span class="pre">by_member()</span></code></a>,
<a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Params.by_param" title="ndf_parse.model.Params.by_param"><code class="xref py py-meth docutils literal notranslate"><span class="pre">by_param()</span></code></a>, <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Map.by_key" title="ndf_parse.model.Map.by_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">by_key()</span></code></a> and similar
methods for finding a single unique element. Strict by default (i.e. will
raise an error and terminate execution if item is not found) which is good
for not getting surprising silent bugs if Eugen removes some field one was
relying on.</p></li>
<li><p>Manually <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.compare" title="ndf_parse.model.abc.List.compare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compare()</span></code></a> list-likes and
<a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.Row.compare" title="ndf_parse.model.abc.Row.compare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compare()</span></code></a> rows. In fact this is what is used under the
hood for <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.match_pattern" title="ndf_parse.model.abc.List.match_pattern"><code class="xref py py-meth docutils literal notranslate"><span class="pre">abc.List.match_pattern()</span></code></a>.</p></li>
</ol>
</section>
<section id="get-and-set-values">
<h3>Get and Set Values<a class="headerlink" href="#get-and-set-values" title="Permalink to this heading">#</a></h3>
<section id="get-and-set-values-for-rows">
<h4>Get and Set Values for Rows<a class="headerlink" href="#get-and-set-values-for-rows" title="Permalink to this heading">#</a></h4>
<p>Getting and setting values in rows is pretty straightforward:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ListRow</span><span class="o">.</span><span class="n">from_ndf</span><span class="p">(</span><span class="s2">&quot;Namespace is 12&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="o">.</span><span class="n">namespace</span>  <span class="c1"># get namespace</span>
<span class="go">&#39;Namespace&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="o">.</span><span class="n">n</span>  <span class="c1"># same but with an alias</span>
<span class="go">&#39;Namespace&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># get value (also has an alias, `v`)</span>
<span class="go">&#39;12&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get row&#39;s visibility (has an alias `vis`, stores values like</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># &#39;unnamed&#39;, &#39;export&#39; etc.)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="o">.</span><span class="n">visibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ^ will not print anything because it&#39;s `None`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># set a value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="mi">24</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="o">.</span><span class="n">namespace</span> <span class="o">=</span> <span class="s2">&quot;NewName&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="o">.</span><span class="n">vis</span> <span class="o">=</span> <span class="s1">&#39;export&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="go">export NewName is 24</span>
</pre></div>
</div>
<p>All possible values and methods for rows are documented in <a class="reference internal" href="ndf-parse/model.html#module-ndf_parse.model" title="ndf_parse.model"><code class="xref py py-mod docutils literal notranslate"><span class="pre">model</span></code></a> plus
shared methods are described in <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.Row" title="ndf_parse.model.abc.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.abc.Row</span></code></a>.</p>
</section>
<section id="get-and-set-values-for-list-likes">
<h4>Get and Set Values for List-Likes<a class="headerlink" href="#get-and-set-values-for-list-likes" title="Permalink to this heading">#</a></h4>
<p>List-likes can be queried for items as any other pythonic list. Above that they
have methods for searching (and removing) rows by specific attributes (as was
demonstrated in <a class="reference internal" href="#search-tools"><span class="std std-ref">search tools</span></a>). They also share a bunch of
methods like <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.add" title="ndf_parse.model.abc.List.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code></a> (used in quickstart to add a <code class="docutils literal notranslate"><span class="pre">'HE'</span></code>
trait), <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.insert" title="ndf_parse.model.abc.List.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert()</span></code></a>, <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.replace" title="ndf_parse.model.abc.List.replace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">replace()</span></code></a> and
<a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.remove" title="ndf_parse.model.abc.List.remove"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove()</span></code></a>. Their API is well documented in their
<a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List" title="ndf_parse.model.abc.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">parent</span> <span class="pre">class</span></code></a>.</p>
<p>A couple things worth mentioning:</p>
<ol class="arabic">
<li><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Map" title="ndf_parse.model.Map"><code class="xref py py-class docutils literal notranslate"><span class="pre">Map</span></code></a> differs from others in that it also accepts pairs as
row representations:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mymap</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mymap</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="s2">&quot;&#39;key1&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;value1&#39;&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;&#39;key2&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;24&quot;</span><span class="p">))</span>
<span class="go">[MapRow[0](key=&quot;&#39;key1&#39;&quot;, value=&quot;&#39;value1&#39;&quot;),</span>
<span class="go">MapRow[1](key=&quot;&#39;key2&#39;&quot;, value=&#39;24&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">mymap</span><span class="p">)</span>
<span class="go">MAP[(&#39;key1&#39;, &#39;value1&#39;), (&#39;key2&#39;, 24)]</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List" title="ndf_parse.model.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.List</span></code></a>, <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Object" title="ndf_parse.model.Object"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.Object</span></code></a> and <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Template" title="ndf_parse.model.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.Template</span></code></a> all
store their type inside of their own <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Object.type" title="ndf_parse.model.Object.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> attribute
instead of row’s one. This issue is covered in detail in <a class="reference internal" href="#typing-ambiguity"><span class="std std-ref">typing
ambiguity</span></a> section.</p></li>
<li><p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List" title="ndf_parse.model.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.List</span></code></a> differs in how it <a class="reference internal" href="#source-is-a-list-but-its-not"><span class="std std-ref">parses ndf code snippets</span></a>.</p></li>
<li><p>All row types are convertable into an integer. They return their index within
a parent list-like. This allows us to do the following:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">row_from</span><span class="p">,</span> <span class="n">row_to</span>  <span class="c1"># two rows from a list</span>
<span class="go">(MapRow[3](key=&#39;Key3&#39;, value=&#39;3&#39;),</span>
<span class="go">MapRow[6](key=&#39;Key6&#39;, value=&#39;6&#39;))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mymap</span>  <span class="c1"># the list</span>
<span class="go">Map[MapRow[0](key=&#39;Key0&#39;, value=&#39;0&#39;),</span>
<span class="go">MapRow[1](key=&#39;Key1&#39;, value=&#39;1&#39;),</span>
<span class="go">MapRow[2](key=&#39;Key2&#39;, value=&#39;2&#39;),</span>
<span class="go">MapRow[3](key=&#39;Key3&#39;, value=&#39;3&#39;),</span>
<span class="go">MapRow[4](key=&#39;Key4&#39;, value=&#39;4&#39;),</span>
<span class="go">MapRow[5](key=&#39;Key5&#39;, value=&#39;5&#39;),</span>
<span class="go">MapRow[6](key=&#39;Key6&#39;, value=&#39;6&#39;),</span>
<span class="go">MapRow[7](key=&#39;Key7&#39;, value=&#39;7&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">mymap</span><span class="p">[</span><span class="n">row_from</span> <span class="p">:</span> <span class="n">row_to</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mymap</span>  <span class="c1"># list has now lost 3 rows including the `row_from`</span>
<span class="go">Map[MapRow[0](key=&#39;Key0&#39;, value=&#39;0&#39;),</span>
<span class="go">MapRow[1](key=&#39;Key1&#39;, value=&#39;1&#39;),</span>
<span class="go">MapRow[2](key=&#39;Key2&#39;, value=&#39;2&#39;),</span>
<span class="go">MapRow[3](key=&#39;Key6&#39;, value=&#39;6&#39;),</span>
<span class="go">MapRow[4](key=&#39;Key7&#39;, value=&#39;7&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row_from</span>  <span class="c1"># it is now dangling</span>
<span class="go">MapRow[DANGLING](key=&#39;Key3&#39;, value=&#39;3&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row_to</span>  <span class="c1"># this row is tracking it&#39;s position accordingly</span>
<span class="go">MapRow[3](key=&#39;Key6&#39;, value=&#39;6&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mymap</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">row_to</span><span class="p">)</span> <span class="c1"># remove the second too</span>
<span class="go">MapRow[DANGLING](key=&#39;Key6&#39;, value=&#39;6&#39;)</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Just don’t try using a dangling pointer as an index, it will crash.</p>
</div>
</li>
</ol>
</section>
</section>
<section id="create-new-values">
<h3>Create New Values<a class="headerlink" href="#create-new-values" title="Permalink to this heading">#</a></h3>
<section id="create-new-list-likes">
<h4>Create New List-Likes<a class="headerlink" href="#create-new-list-likes" title="Permalink to this heading">#</a></h4>
<p>Lists are all mostly created via a direct constructor call. The logic is “make
a new list and add stuff after”. Examples:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span>  <span class="c1"># an alias for brevity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf_print</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">print</span>  <span class="c1"># also an alias</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># a new map</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="go">Map[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># a new template</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpl</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">Template</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpl</span>
<span class="go">Template[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpl</span><span class="o">.</span><span class="n">params</span>  <span class="c1"># we can also query it&#39;s md.Params section if we want</span>
<span class="go">Params[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span><span class="o">.</span><span class="n">Params</span><span class="p">()</span>  <span class="c1"># or make a new one</span>
<span class="go">Params[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># a new list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf_print</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;RGB&quot;</span>  <span class="c1"># make it typed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf_print</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
<span class="go">RGB[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf_print</span><span class="p">(</span><span class="n">md</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;RGB&quot;</span><span class="p">))</span>  <span class="c1"># or create it already typed</span>
<span class="go">RGB[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># a new source</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">is_root</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">List[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># yes, source is just a List with a flag on. And you can convert</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># one into the other just by altering `lst.is_root` parameter.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># this also affects the type of snippets it accepts, more on that</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># in &quot;Source Is a List But It&#39;s Not&quot; section.`</span>
</pre></div>
</div>
<p>It would be nice to have an option to directly initialize them with code
snippets, like <code class="code highlight py docutils literal highlight-py"><span class="n">md</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="s2">&quot;A is 12, B is 24&quot;</span><span class="p">)</span></code> but there are 2 issues:
<a class="reference internal" href="#source-is-a-list-but-its-not"><span class="std std-ref">List is a special case</span></a> that makes parsing
snippets context-dependent and a risk of type collisions for list-like args vs
row args. This is resolvable in the future, it just requires time. For now if
one is really determined in creating lists via snippets, there is a workaround:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf_print</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">print</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># a new source from a snippet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;A is 12</span><span class="se">\n</span><span class="s2">B is 24</span><span class="se">\n</span><span class="s2">C is Obj(memb = 12)&quot;</span><span class="p">)</span>  <span class="c1"># \n denotes a newline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf_print</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="go">A is 12</span>
<span class="go">B is 24</span>
<span class="go">C is Obj</span>
<span class="go">(</span>
<span class="go">    memb = 12</span>
<span class="go">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">A is 12</span>
<span class="gp">... </span><span class="s2">B is 24</span>
<span class="gp">... </span><span class="s2">C is Obj(memb = 12)</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span> <span class="c1"># snippet with multiline string, a bit easier to read</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf_print</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="go">A is 12</span>
<span class="go">B is 24</span>
<span class="go">C is Obj</span>
<span class="go">(</span>
<span class="go">    memb = 12</span>
<span class="go">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># any Map/List/Object/Template (Param is a bit tricky, but doable)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># snippet below will return a dict with row&#39;s arguments mapped as keys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (it&#39;s this way because of how internal converter works, just accept it as is)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_wrapped</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s2">&quot;MAP[(&#39;A&#39;, 1), (&#39;B&#39;, 2)]&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_wrapped</span>
<span class="go">{&#39;value&#39;: Map[MapRow[0](key=&quot;&#39;A&#39;&quot;, value=&#39;1&#39;), MapRow[1](key=&quot;&#39;B&#39;&quot;, value=&#39;2&#39;)]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_wrapped</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>  <span class="c1"># fetch the row itself</span>
<span class="go">Map[MapRow[0](key=&quot;&#39;A&#39;&quot;, value=&#39;1&#39;), MapRow[1](key=&quot;&#39;B&#39;&quot;, value=&#39;2&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s2">&quot;MAP[(&#39;A&#39;, 1), (&#39;B&#39;, 2)]&quot;</span><span class="p">)[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>  <span class="c1"># same, just a oneliner</span>
<span class="go">Map[MapRow[0](key=&quot;&#39;A&#39;&quot;, value=&#39;1&#39;), MapRow[1](key=&quot;&#39;B&#39;&quot;, value=&#39;2&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># you can make a helper function if ypu use it alot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">mk_listlike</span><span class="p">(</span><span class="n">snippet</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">ndf</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="n">snippet</span><span class="p">)[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mk_listlike</span><span class="p">(</span><span class="s2">&quot;[1, 2, 3]&quot;</span><span class="p">)</span>
<span class="go">List[ListRow[0](value=&#39;1&#39;, visibility=None, namespace=None),</span>
<span class="go">ListRow[1](value=&#39;2&#39;, visibility=None, namespace=None),</span>
<span class="go">ListRow[2](value=&#39;3&#39;, visibility=None, namespace=None)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mk_listlike</span><span class="p">(</span><span class="s2">&quot;MAP[(&#39;A&#39;, 1), (&#39;B&#39;, 2)]&quot;</span><span class="p">)</span>
<span class="go">Map[MapRow[0](key=&quot;&#39;A&#39;&quot;, value=&#39;1&#39;), MapRow[1](key=&quot;&#39;B&#39;&quot;, value=&#39;2&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mk_listlike</span><span class="p">(</span><span class="s2">&quot;Obj(memb1 = 12</span><span class="se">\n</span><span class="s2">memb2 = 24)&quot;</span><span class="p">)</span>
<span class="go">Object[MemberRow[0](value=&#39;12&#39;, member=&#39;memb1&#39;, type=None,</span>
<span class="go">visibility=None, namespace=None),</span>
<span class="go">MemberRow[1](value=&#39;24&#39;, member=&#39;memb2&#39;, type=None,</span>
<span class="go">visibility=None, namespace=None)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mk_listlike</span><span class="p">(</span><span class="s2">&quot;template Templ[parm1, parm2 = 12] is Obj(memb1 = &lt;parm1&gt;</span><span class="se">\n</span><span class="s2">memb2 = &lt;parm2&gt;)&quot;</span><span class="p">)</span>
<span class="go">Template[MemberRow[0](value=&#39;&lt;parm1&gt;&#39;, member=&#39;memb1&#39;, type=None, visibility=None, namespace=None),</span>
<span class="go">MemberRow[1](value=&#39;&lt;parm2&gt;&#39;, member=&#39;memb2&#39;, type=None, visibility=None, namespace=None)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or grab just params of a template</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mk_listlike</span><span class="p">(</span><span class="s2">&quot;template T[parm1, parm2 = 12] is Obj()&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">params</span>
<span class="go">Params[ParamRow[0](param=&#39;parm1&#39;, type=None, value=None),</span>
<span class="go">ParamRow[1](param=&#39;parm2&#39;, type=None, value=&#39;12&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># and here is a demonstration of how `expression` works since we&#39;re at it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s2">&quot;template T[parm1, parm2 = 12] is Obj()&quot;</span><span class="p">)</span>
<span class="go">{&#39;value&#39;: Template[], &#39;namespace&#39;: &#39;T&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s2">&quot;export Name is Obj()&quot;</span><span class="p">)</span>
<span class="go">{&#39;value&#39;: Object[], &#39;namespace&#39;: &#39;Name&#39;, &#39;visibility&#39;: &#39;export&#39;}</span>
</pre></div>
</div>
</section>
<section id="create-new-rows">
<h4>Create New Rows<a class="headerlink" href="#create-new-rows" title="Permalink to this heading">#</a></h4>
<p>New rows can be created in a multitude of ways:</p>
<ol class="arabic">
<li><p>Create rows directly inside of a list:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;A is 12&quot;</span><span class="p">)</span>  <span class="c1"># create via snippet</span>
<span class="go">ListRow[0](value=&#39;12&#39;, visibility=None, namespace=&#39;A&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span><span class="o">.</span><span class="n">add</span><span class="p">({</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s2">&quot;24&quot;</span><span class="p">,</span> <span class="s1">&#39;namespace&#39;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">})</span>  <span class="c1"># create as a dict</span>
<span class="go">ListRow[1](value=&#39;24&#39;, visibility=None, namespace=&#39;B&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;42&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>  <span class="c1"># create directly via args</span>
<span class="go">ListRow[2](value=&#39;42&#39;, visibility=None, namespace=&#39;C&#39;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>List-likes also support methods like <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.insert" title="ndf_parse.model.abc.List.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert()</span></code></a>,
<a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.replace" title="ndf_parse.model.abc.List.replace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">replace()</span></code></a>, <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.remove" title="ndf_parse.model.abc.List.remove"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove()</span></code></a> as well
as pythonic getters/setters (<cite>lst[0] = …</cite>). Please read <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List" title="ndf_parse.model.abc.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">the</span>
<span class="pre">reference</span></code></a>, it’s extensively documented there plus
some additional info (like ability to add rows via lists and iterables).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Map" title="ndf_parse.model.Map"><code class="xref py py-class docutils literal notranslate"><span class="pre">Map</span></code></a> has additional ability to accept rows as plain
python tuples:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mymap</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mymap</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">))</span>
<span class="go">MapRow[0](key=&#39;A&#39;, value=&#39;1&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># pythonic way with a caveat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mymap</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">),</span>  <span class="c1"># &gt;&gt;&gt; NOTE THE COMMA AT THE END &lt;&lt;&lt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mymap</span>
<span class="go">Map[MapRow[0](key=&#39;B&#39;, value=&#39;2&#39;)]</span>
</pre></div>
</div>
<p>You can find out <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Map" title="ndf_parse.model.Map"><code class="xref py py-class docutils literal notranslate"><span class="pre">here</span></code></a> why there is an extra comma
in a pythonic setter.</p>
</div>
</li>
<li><p>Create dangling rows with snippets:</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span><span class="o">.</span><span class="n">ListRow</span><span class="o">.</span><span class="n">from_ndf</span><span class="p">(</span><span class="s2">&quot;private Namespace is Value&quot;</span><span class="p">)</span>
<span class="go">ListRow[DANGLING](value=&#39;Value&#39;, visibility=&#39;private&#39;, namespace=&#39;Namespace&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span><span class="o">.</span><span class="n">MemberRow</span><span class="o">.</span><span class="n">from_ndf</span><span class="p">(</span><span class="s2">&quot;member_name : member_type = Value&quot;</span><span class="p">)</span>
<span class="go">MemberRow[DANGLING](value=&#39;Value&#39;, member=&#39;member_name&#39;,</span>
<span class="go">type=&#39;member_type&#39;, visibility=None, namespace=None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span><span class="o">.</span><span class="n">ParamRow</span><span class="o">.</span><span class="n">from_ndf</span><span class="p">(</span><span class="s2">&quot;param_name: param_type = Value&quot;</span><span class="p">)</span>
<span class="go">ParamRow[DANGLING](param=&#39;param_name&#39;, type=&#39;param_type&#39;, value=&#39;Value&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span><span class="o">.</span><span class="n">MapRow</span><span class="o">.</span><span class="n">from_ndf</span><span class="p">(</span><span class="s2">&quot;(&#39;key&#39;, Value)&quot;</span><span class="p">)</span>  <span class="c1"># note there are parenthesies!</span>
<span class="go">MapRow[DANGLING](key=&quot;&#39;key&#39;&quot;, value=&#39;Value&#39;)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Create dangling rows manually:</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># from dict decomposition (supports aliases)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span><span class="o">.</span><span class="n">ListRow</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="s1">&#39;vis&#39;</span><span class="p">:</span><span class="s1">&#39;private&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="s1">&#39;Namespace&#39;</span><span class="p">})</span>
<span class="go">ListRow[DANGLING](value=&#39;Value&#39;, visibility=&#39;private&#39;, namespace=&#39;Namespace&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># from args (supports aliases)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span><span class="o">.</span><span class="n">MemberRow</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="s1">&#39;member_name&#39;</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="s1">&#39;member_type&#39;</span><span class="p">,</span> <span class="n">vis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">MemberRow[DANGLING](value=&#39;Value&#39;, member=&#39;member_name&#39;,</span>
<span class="go">type=&#39;member_type&#39;, visibility=None, namespace=None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># special case for Map - pair tuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span><span class="o">.</span><span class="n">MapRow</span><span class="p">((</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">))</span>
<span class="go">MapRow[DANGLING](key=&#39;key&#39;, value=&#39;Value&#39;)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</section>
</section>
<section id="delete-items">
<h3>Delete Items<a class="headerlink" href="#delete-items" title="Permalink to this heading">#</a></h3>
<p>To delete a value from a row simply replace it with <code class="code highlight py docutils literal highlight-py"><span class="kc">None</span></code> (for
optionals) or a new value (for mandatory parameters, like <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.ListRow.value" title="ndf_parse.model.ListRow.value"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ListRow.value</span></code></a>):</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ListRow</span><span class="o">.</span><span class="n">from_ndf</span><span class="p">(</span><span class="s2">&quot;A is Obj(memb = 12)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span><span class="o">.</span><span class="n">parent_row</span>  <span class="c1"># inner list-like has the row as it&#39;s parent</span>
<span class="go">ListRow[DANGLING](value=Object[MemberRow[0](value=&#39;12&#39;, member=&#39;memb&#39;,</span>
<span class="go">type=None, visibility=None, namespace=None)], visibility=None, namespace=&#39;A&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;12&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># note that on replacing the value the row automatically unparents the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># inner list-like</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span><span class="o">.</span><span class="n">parent_row</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>To delete a row from a list simply use:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;A is 12</span><span class="se">\n</span><span class="s2">B is 24</span><span class="se">\n</span><span class="s2">C is 42&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">source</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span>
<span class="go">List[ListRow[0](value=&#39;12&#39;, visibility=None, namespace=&#39;A&#39;),</span>
<span class="go">ListRow[1](value=&#39;42&#39;, visibility=None, namespace=&#39;C&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we can also use the row itself as an index if needed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span>
<span class="go">ListRow[0](value=&#39;12&#39;, visibility=None, namespace=&#39;A&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">source</span><span class="p">[</span><span class="n">row</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># note that on deleting the row the list automatically unparents it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span>
<span class="go">ListRow[DANGLING](value=&#39;12&#39;, visibility=None, namespace=&#39;A&#39;)</span>
</pre></div>
</div>
</section>
</section>
<section id="printing-an-ndf-code-out">
<h2>Printing an NDF Code Out<a class="headerlink" href="#printing-an-ndf-code-out" title="Permalink to this heading">#</a></h2>
<p>If you want to print data out (for debugging purposes or whatever), you can do
the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Obj1 is Type1(</span>
<span class="linenos"> 4</span><span class="s2">    member1 = Obj2 is Type1(</span>
<span class="linenos"> 5</span><span class="s2">        member1 = nil</span>
<span class="linenos"> 6</span><span class="s2">    )</span>
<span class="linenos"> 7</span><span class="s2">)&quot;&quot;&quot;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="n">source</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># manually convert data instead of using ndf.Mod</span>
<span class="linenos">10</span><span class="n">obj_view</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;// Complete assignment statement (printing the whole row):&quot;</span><span class="p">)</span>
<span class="linenos">13</span><span class="n">ndf</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">obj_view</span><span class="p">)</span>
<span class="linenos">14</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;// Object declaration only (row&#39;s value only):&quot;</span><span class="p">)</span>
<span class="linenos">15</span><span class="n">ndf</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">obj_view</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>This code should print out the following:</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">Ndf Output</span><a class="headerlink" href="#id11" title="Permalink to this code">#</a></div>
<div class="highlight-ndf notranslate"><div class="highlight"><pre><span></span><span class="c1">// Complete assignment statement (printing the whole row):</span>
<span class="n">Obj1</span> <span class="k">is</span> <span class="kt">Type1</span>
<span class="p">(</span>
    <span class="n">member1</span> <span class="o">=</span> <span class="n">Obj2</span> <span class="k">is</span> <span class="kt">Type1</span>
    <span class="p">(</span>
        <span class="n">member1</span> <span class="o">=</span> <span class="bp">nil</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="c1">// Object declaration only (row&#39;s value only):</span>
<span class="kt">Type1</span>
<span class="p">(</span>
    <span class="n">member1</span> <span class="o">=</span> <span class="n">Obj2</span> <span class="k">is</span> <span class="kt">Type1</span>
    <span class="p">(</span>
        <span class="n">member1</span> <span class="o">=</span> <span class="bp">nil</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>There are 2 other functions you might find useful:</p>
<ul class="simple">
<li><p><a class="reference internal" href="ndf-parse/printer.html#ndf_parse.printer.string" title="ndf_parse.printer.string"><code class="xref py py-func docutils literal notranslate"><span class="pre">printer.string()</span></code></a>, returns ndf code as a string instead of dumping it to
stdout.</p></li>
<li><p><a class="reference internal" href="ndf-parse/printer.html#ndf_parse.printer.format" title="ndf_parse.printer.format"><code class="xref py py-func docutils literal notranslate"><span class="pre">printer.format()</span></code></a>, wtires ndf code out to an IO handle.
<a class="reference internal" href="ndf-parse/printer.html#ndf_parse.printer.print" title="ndf_parse.printer.print"><code class="xref py py-func docutils literal notranslate"><span class="pre">printer.print()</span></code></a> used above is actually a wrapper around this function.</p></li>
</ul>
</section>
<section id="general-recommendations-and-caveats">
<h2>General Recommendations and Caveats<a class="headerlink" href="#general-recommendations-and-caveats" title="Permalink to this heading">#</a></h2>
<section id="errors-suppression">
<h3>Errors Suppression<a class="headerlink" href="#errors-suppression" title="Permalink to this heading">#</a></h3>
<p>Avoid using <code class="code highlight py docutils literal highlight-py"><span class="k">try</span></code> clause or any other silently failing operations. If
Eugen renames or moves objects or members that you’re editing - it’s in your
best interest to let the script fail instead of silently ignoring missing member
or namespace. That way you will know 100% something has changed in the source
code and needs fixing instead of bashing your head over a compiled mod that
doesn’t do what you expect from it.</p>
<p>For that reason some functions use <code class="docutils literal notranslate"><span class="pre">strict</span></code> argument with <code class="code highlight py docutils literal highlight-py"><span class="kc">True</span></code> by
default <a class="reference internal" href="#strict-attributes">(more on that here)</a> that forces them to fail if
anything is off. Don’t turn those off unless you really know that it won’t hurt
you in the long run.</p>
</section>
<section id="nested-edits">
<h3>Nested Edits<a class="headerlink" href="#nested-edits" title="Permalink to this heading">#</a></h3>
<p>Avoid nesting <code class="code highlight py docutils literal highlight-py"><span class="k">with</span> <span class="n">mod</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="o">...</span><span class="p">)</span></code> inside of another <code class="code highlight py docutils literal highlight-py"><span class="k">with</span>
<span class="n">mod</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="o">...</span><span class="p">)</span></code> if they both access the same source file. First clause will build
an independent tree from pristine source mode. Second one will build another
independent tree from pristine source mode. When second clause ends, your file
gets written out with all the changes you made in the second clause. But your
first tree still holds data from original unedited tree. As soon as it gets
written out, it will overwrite anything you did in the second clause.</p>
</section>
<section id="syntax-checking-strictness">
<span id="checking-strictness"></span><h3>Syntax Checking Strictness<a class="headerlink" href="#syntax-checking-strictness" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://github.com/Ulibos/tree-sitter-ndf">tree-sitter-ndf</a> parser is not a language server so it will allow for
some not-quite-correct expressions. It will only catch the most bogus syntax
errors while will let through things like excessive commas, multiple <code class="docutils literal notranslate"><span class="pre">unnamed</span></code>
definitions, clashing namespaces and <code class="docutils literal notranslate"><span class="pre">member</span></code> definitions at the root level.
You can read more on this in <a class="reference external" href="https://github.com/Ulibos/tree-sitter-ndf">tree-sitter-ndf’s README.md</a>.</p>
</section>
<section id="source-is-a-list-but-it-s-not">
<span id="source-is-a-list-but-its-not"></span><h3>Source Is a List But It’s Not<a class="headerlink" href="#source-is-a-list-but-it-s-not" title="Permalink to this heading">#</a></h3>
<p>Ndf syntax is inconsistent with respect to usage of commas. If you have an ndf
list then you have to separate entries with commas:</p>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">Ndf Code</span><a class="headerlink" href="#id12" title="Permalink to this code">#</a></div>
<div class="highlight-ndf notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">var1</span> <span class="k">is</span> <span class="mi">12</span><span class="p">,</span> <span class="n">var2</span> <span class="k">is</span> <span class="mi">24</span><span class="p">,</span> <span class="n">var3</span> <span class="k">is</span> <span class="mi">42</span><span class="p">,</span> <span class="n">SomeObject</span> <span class="k">is</span> <span class="kt">Type</span><span class="p">(</span><span class="n">member1</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<p>On the other hand, the root level declarations always use newlines and never
commas:</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">Ndf Code</span><a class="headerlink" href="#id13" title="Permalink to this code">#</a></div>
<div class="highlight-ndf notranslate"><div class="highlight"><pre><span></span><span class="n">var1</span> <span class="k">is</span> <span class="mi">12</span>
<span class="n">var2</span> <span class="k">is</span> <span class="mi">24</span>
<span class="n">var3</span> <span class="k">is</span> <span class="mi">42</span>
<span class="n">SomeObject</span> <span class="k">is</span> <span class="kt">Type</span><span class="p">(</span><span class="n">member1</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Both declarations operate virtually the same way so <a class="reference internal" href="ndf-parse.html#module-ndf_parse" title="ndf_parse"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndf_parse</span></code></a> uses the
same class (<a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List" title="ndf_parse.model.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.List</span></code></a>) to implement both, the only thing that makes
the difference is the <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List.is_root" title="ndf_parse.model.List.is_root"><code class="xref py py-attr docutils literal notranslate"><span class="pre">model.List.is_root</span></code></a> attribute. If it’s
<code class="code highlight py docutils literal highlight-py"><span class="kc">True</span></code> then it will act like a source root. It will print with
newlines instead of commas and will expect ndf code arguments to
<a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.insert" title="ndf_parse.model.abc.List.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert()</span></code></a> and <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.add" title="ndf_parse.model.abc.List.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code></a> with newlines as
statements separators. If <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List.is_root" title="ndf_parse.model.List.is_root"><code class="xref py py-attr docutils literal notranslate"><span class="pre">is_root</span></code></a> is <code class="code highlight py docutils literal highlight-py"><span class="kc">False</span></code> then
it will act like a simple list and will expect ndf code arguments to have commas
as separators. Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">is_root</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># initialize as a simple list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;1, 2, 3&quot;</span><span class="p">)</span>
<span class="go">[List[0](value=&#39;1&#39;, visibility=None, namespace=None),</span>
<span class="go">List[1](value=&#39;2&#39;, visibility=None, namespace=None),</span>
<span class="go">List[2](value=&#39;3&#39;, visibility=None, namespace=None)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
<span class="go">[1, 2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span><span class="o">.</span><span class="n">is_root</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># switch it to behave like a source root</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">4</span>
<span class="gp">... </span><span class="s2">Obj is 5</span>
<span class="gp">... </span><span class="s2">Obj is Type()</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="go">[List[3](value=&#39;4&#39;, visibility=None, namespace=None),</span>
<span class="go">List[4](value=&#39;5&#39;, visibility=None, namespace=&#39;Obj&#39;),</span>
<span class="go">List[5](value=Object[], visibility=None, namespace=&#39;Obj&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndf</span><span class="o">.</span><span class="n">printer</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">4</span>
<span class="go">Obj is 5</span>
<span class="go">Obj is Type()</span>
</pre></div>
</div>
</section>
<section id="path-relativeness">
<span id="id4"></span><h3>Path Relativeness<a class="headerlink" href="#path-relativeness" title="Permalink to this heading">#</a></h3>
<p>By default python interprets relative paths relative to where the program was
started. If for example you have your script in <code class="docutils literal notranslate"><span class="pre">C:\Users\User\Scripts\mod.py</span></code>
but run your terminal from <code class="docutils literal notranslate"><span class="pre">C:\</span></code>, your script will interpret all relative paths
relative to <code class="docutils literal notranslate"><span class="pre">C:\</span></code>. If you want your script to always interpert paths relative
to itself, you can add these 2 lines at the beginning of your srcipt:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
</pre></div>
</div>
<p>This rule however is not applicable to <a class="reference internal" href="ndf-parse.html#ndf_parse.Mod.edit" title="ndf_parse.Mod.edit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Mod.edit()</span></code></a>, <a class="reference internal" href="ndf-parse.html#ndf_parse.Mod.parse_src" title="ndf_parse.Mod.parse_src"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Mod.parse_src()</span></code></a>
and <a class="reference internal" href="ndf-parse.html#ndf_parse.Mod.parse_dst" title="ndf_parse.Mod.parse_dst"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Mod.parse_dst()</span></code></a>. These methods operate relative to <a class="reference internal" href="ndf-parse.html#ndf_parse.Mod.mod_src" title="ndf_parse.Mod.mod_src"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Mod.mod_src</span></code></a>
(for <a class="reference internal" href="ndf-parse.html#ndf_parse.Mod.edit" title="ndf_parse.Mod.edit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Mod.edit()</span></code></a> and <a class="reference internal" href="ndf-parse.html#ndf_parse.Mod.parse_src" title="ndf_parse.Mod.parse_src"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Mod.parse_src()</span></code></a>) and <a class="reference internal" href="ndf-parse.html#ndf_parse.Mod.mod_dst" title="ndf_parse.Mod.mod_dst"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Mod.mod_dst</span></code></a> (for
<a class="reference internal" href="ndf-parse.html#ndf_parse.Mod.parse_dst" title="ndf_parse.Mod.parse_dst"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Mod.parse_dst()</span></code></a> and <a class="reference internal" href="ndf-parse.html#ndf_parse.Mod.write_edit" title="ndf_parse.Mod.write_edit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Mod.write_edit()</span></code></a>, just make sure you generated
some data there before trying to access it).</p>
</section>
<section id="typing-ambiguity">
<span id="id5"></span><h3>Typing Ambiguity<a class="headerlink" href="#typing-ambiguity" title="Permalink to this heading">#</a></h3>
<p>Ndf manual is not very clear on it’s typing annotation rules. Consider the following
example:</p>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">Ndf Code</span><a class="headerlink" href="#id14" title="Permalink to this code">#</a></div>
<div class="highlight-ndf notranslate"><div class="highlight"><pre><span></span><span class="n">MemberTyping</span> <span class="k">is</span> <span class="kt">TObject</span><span class="p">(</span>  <span class="c1">// object is of type TObject</span>
  <span class="c1">// member is of type string</span>
  <span class="n">StringMember</span> <span class="p">:</span> <span class="kt">string</span> <span class="o">=</span> <span class="s2">&quot;Some text&quot;</span>

  <span class="c1">// case similar to one in the manual, we have both member and namespace names</span>
  <span class="n">ObjectMember</span> <span class="o">=</span> <span class="n">InnerNamespace</span> <span class="k">is</span> <span class="kt">TObject</span><span class="p">(</span> <span class="sr">.</span><span class="p">..</span> <span class="p">)</span>

  <span class="c1">// syntax allows for this in theory</span>
  <span class="n">WtfMember</span> <span class="p">:</span> <span class="kt">MType</span> <span class="o">=</span> <span class="n">CanWeDoThis</span> <span class="k">is</span> <span class="kt">TObject</span><span class="p">(</span> <span class="sr">.</span><span class="p">..</span> <span class="p">)</span>
  <span class="n">AnotherOne</span> <span class="p">:</span> <span class="kt">RGBA</span> <span class="o">=</span> <span class="kt">RGBA</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Since there are no clear instructions on wheter this is possible and syntax
rules don’t seem to prohibit such declaration, I had to opt for a cursed
solution - <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Template" title="ndf_parse.model.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.Template</span></code></a>, <a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.Object" title="ndf_parse.model.Object"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.Object</span></code></a> and
<a class="reference internal" href="ndf-parse/model.html#ndf_parse.model.List" title="ndf_parse.model.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.List</span></code></a> have a <code class="docutils literal notranslate"><span class="pre">type</span></code> parameter that stores their mandatory type
declaration (<code class="docutils literal notranslate"><span class="pre">TObject</span></code> in this example). So for these specific objects don’t
rely on row’s <code class="docutils literal notranslate"><span class="pre">type</span></code> parameter. For everything else Row’s <code class="docutils literal notranslate"><span class="pre">type</span></code> is the way
to go.</p>
</section>
<section id="no-referencing">
<span id="id6"></span><h3>No Referencing<a class="headerlink" href="#no-referencing" title="Permalink to this heading">#</a></h3>
<p><a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List" title="ndf_parse.model.abc.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.abc.List</span></code></a>, <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.Row" title="ndf_parse.model.abc.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.abc.Row</span></code></a> and their subclasses are
implemented with no copy by reference in mind. This is done to prevent
unexpected side effects when editing data (accidentally mutating the row you
wanted to copy). An example to illustrate the issue:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># this is not an ``ndf_parse`` code, these are builtin python types</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_source</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;my_variable&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;12&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_source</span><span class="p">)</span>  <span class="c1"># we want to copy our data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_source</span><span class="p">)</span>  <span class="c1"># we want to make another copy and edit it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;24&#39;</span>  <span class="c1"># edit the second item in the list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># check the edit</span>
<span class="go">{&#39;name&#39;: &#39;my_variable&#39;, &#39;value&#39;: &#39;24&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># all good, value is edited</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># check that the first item is still 12</span>
<span class="go">{&#39;name&#39;: &#39;my_variable&#39;, &#39;value&#39;: &#39;24&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># what?.. both values have changed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_source</span>  <span class="c1"># check the original dict just in case</span>
<span class="go">{&#39;name&#39;: &#39;my_variable&#39;, &#39;value&#39;: &#39;24&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># !!! all 3 have changed !!!</span>
</pre></div>
</div>
<p>This happens because by default mutable objects (which are the vast majority in
python) are passed by reference. So <code class="docutils literal notranslate"><span class="pre">data_source</span></code> and both <code class="docutils literal notranslate"><span class="pre">scene</span></code> entries
reference the same place in memory. We can easily fix it by importing the
<code class="docutils literal notranslate"><span class="pre">copy</span></code> module and appending like
<code class="code highlight py docutils literal highlight-py"><span class="n">scene</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_source</span><span class="p">))</span></code> but that would become very
verbose very fast. So <a class="reference internal" href="ndf-parse.html#module-ndf_parse" title="ndf_parse"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ndf_parse</span></code></a> is implemented with deep copying on
assignment (to it’s lists) by default. Whenever a <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.Row" title="ndf_parse.model.abc.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.abc.Row</span></code></a> is
inserted into a <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List" title="ndf_parse.model.abc.List"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>, it always makes a deep copy of itself
(only exception is if it was a dangling row, i.e. it had no parent list
previously). An example to illustrate the implementation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># this is an ``ndf_parse`` code with it&#39;s types</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">model</span>  <span class="c1"># a simple alias to save on typing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">is_root</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># make a scene</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">ListRow</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;Var1&#39;</span><span class="p">)</span>  <span class="c1"># create a dangling row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span>  <span class="c1"># check it</span>
<span class="go">ListRow[DANGLING](value=&#39;12&#39;, visibility=None, namespace=&#39;Var1&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>  <span class="c1"># add 1st row, will get attached because is dangling</span>
<span class="go">List[0](value=&#39;12&#39;, visibility=None, namespace=&#39;Var1&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="ow">is</span> <span class="n">scene</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># our row is now attached to the scene</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>  <span class="c1"># add 2nd row, will copy because already has a parent</span>
<span class="go">List[1](value=&#39;12&#39;, visibility=None, namespace=&#39;Var1&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="ow">is</span> <span class="n">scene</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># make sure second insert is a new object</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="s1">&#39;24&#39;</span>  <span class="c1"># edit the second row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># check the edit</span>
<span class="go">List[1](value=&#39;24&#39;, visibility=None, namespace=&#39;Var1&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scene</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># check the original</span>
<span class="go">List[0](value=&#39;12&#39;, visibility=None, namespace=&#39;Var1&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># all good, value is still 12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># if you want your ``row`` variable to point to the last inserted row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># for ease of editing, then do this:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>  <span class="c1"># ``add()`` will return the inserted row</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="ow">is</span> <span class="n">scene</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># row now refers to the last insertion</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="ow">is</span> <span class="n">scene</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># and no longer refers to the first insertion</span>
<span class="go">False</span>
</pre></div>
</div>
</section>
<section id="strict-attributes-in-edits">
<span id="strict-attributes"></span><h3>Strict Attributes in Edits<a class="headerlink" href="#strict-attributes-in-edits" title="Permalink to this heading">#</a></h3>
<p>By default methods like <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.Row.edit" title="ndf_parse.model.abc.Row.edit"><code class="xref py py-func docutils literal notranslate"><span class="pre">edit()</span></code></a>, <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.add" title="ndf_parse.model.abc.List.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a>
and <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.insert" title="ndf_parse.model.abc.List.insert"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert()</span></code></a> operate in a strict mode. This means that
they don’t allow to pass in parameters that aren’t supported by the Row/List
type. This limitation is purely “cosmetic” and servers one purpose: to help one
catch errors early. If one deconstructs an incompatible dict into an
<a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.List.add" title="ndf_parse.model.abc.List.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">add()</span></code></a> function, it will raise and exception to warn about
the error. By setting <cite>_strict</cite> attribute to <code class="code highlight py docutils literal highlight-py"><span class="kc">False</span></code> one can put any
attributes in the call, they will be simply ignored by the function. An example
of how it works and when one might want to override the default behaviour:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ndf_parse</span> <span class="k">as</span> <span class="nn">ndf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">ndf</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;export SomeObj is Obj(a = 12)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span>
<span class="go">List[List[0](value=Object[Object[0](value=&#39;12&#39;, member=&#39;a&#39;, type=None,</span>
<span class="go">visibility=None, namespace=None)], visibility=&#39;export&#39;, namespace=&#39;SomeObj&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="s2">&quot;PI&quot;</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;42&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot set ListRow.test, attribute does not exist.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="s2">&quot;PI&quot;</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;42&quot;</span><span class="p">,</span> <span class="n">_strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># disable strict</span>
<span class="go">List[1](value=&#39;12&#39;, visibility=None, namespace=&#39;PI&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># note there is no &quot;test&quot; attribute, it was dropped</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_param</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="s2">&quot;MyValue&quot;</span><span class="p">,</span> <span class="s2">&quot;vis&quot;</span><span class="p">:</span> <span class="s2">&quot;export&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Something to use in script&#39;s debug output.&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">**</span><span class="n">my_param</span><span class="p">,</span> <span class="n">_strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># disabling strict mode because</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we are sure we won&#39;t break the list with our description</span>
<span class="go">List[2](value=&#39;12&#39;, visibility=&#39;export&#39;, namespace=&#39;MyValue&#39;)</span>
</pre></div>
</div>
</section>
<section id="comparing-strings">
<span id="id7"></span><h3>Comparing Strings<a class="headerlink" href="#comparing-strings" title="Permalink to this heading">#</a></h3>
<p>This tool cuts corners by representing anything that is not a fundamental
structural element (any list-like) as a string. That includes ref paths (even
though the underlying parser knows how to parse those), expressions, ints floats
and strings too. To distinguish, say, an int <code class="code highlight ndf docutils literal highlight-ndf"><span class="mi">12</span></code> from a string
<code class="code highlight ndf docutils literal highlight-ndf"><span class="s2">&quot;12&quot;</span></code> we embed quotes themselves into python’s strings. So if we
have an ndf code that looks like this:</p>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">Ndf Code</span><a class="headerlink" href="#id15" title="Permalink to this code">#</a></div>
<div class="highlight-ndf notranslate"><div class="highlight"><pre><span></span><span class="n">SomeInt</span> <span class="k">is</span> <span class="mi">12</span> <span class="c1">// This is an int</span>
<span class="n">SomeString</span> <span class="k">is</span> <span class="s2">&quot;12&quot;</span> <span class="c1">// this is a string, not an int</span>
<span class="n">IllMakeYouSuffer</span> <span class="k">is</span> <span class="s1">&#39;12&#39;</span> <span class="c1">// string again but with single quotes</span>
</pre></div>
</div>
</div>
<p>We would get the following items in python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ListRow</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">,</span> <span class="n">visibility</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;SomeInt&#39;</span><span class="p">)</span>
<span class="c1">#              v  v note embedded quotes in `value`</span>
<span class="n">ListRow</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;&quot;12&quot;&#39;</span><span class="p">,</span> <span class="n">visibility</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;SomeString&#39;</span><span class="p">)</span>
<span class="c1">#              v  v note embedded quotes but inverted (python adapts to the content)</span>
<span class="n">ListRow</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;&#39;12&#39;&quot;</span><span class="p">,</span> <span class="n">visibility</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;IllMakeYouSuffer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The caveat is that even though <cite>SomeString</cite> and <cite>IllMakeYouSuffer</cite> are logically
the same thing, in python <code class="code highlight py docutils literal highlight-py"><span class="s1">&#39;&quot;12&quot;&#39;</span> <span class="o">!=</span> <span class="s2">&quot;&#39;12&#39;&quot;</span></code> ! It would be nice to
account for that in <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.Row.compare" title="ndf_parse.model.abc.Row.compare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Row.compare()</span></code></a>
method but for now it’s not there because 1) time 2) edge cases. So you should
be careful when comparing such stuff. Since you know the context when working
with specific data, you can either keep track of which quotes you are using or
strip them before comparing stuff. First method is preferrable because you can’t
embed stripping inside existing methods like aforementioned <a class="reference internal" href="ndf-parse/model/abc.html#ndf_parse.model.abc.Row.compare" title="ndf_parse.model.abc.Row.compare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Row.compare()</span></code></a>.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="ndf-parse.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">ndf-parse</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="overview.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Overview</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Ulibos, 2023-2024
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Documentation</a><ul>
<li><a class="reference internal" href="#quick-start">Quick Start</a><ul>
<li><a class="reference internal" href="#before-we-begin">Before We Begin</a></li>
<li><a class="reference internal" href="#make-the-script">Make The Script</a></li>
</ul>
</li>
<li><a class="reference internal" href="#quick-start-explained">Quick Start Explained</a><ul>
<li><a class="reference internal" href="#setting-up">Setting Up</a></li>
<li><a class="reference internal" href="#edits">Edits</a></li>
<li><a class="reference internal" href="#navigating-model-instances">Navigating model Instances</a></li>
<li><a class="reference internal" href="#search-tools">Search Tools</a></li>
<li><a class="reference internal" href="#get-and-set-values">Get and Set Values</a><ul>
<li><a class="reference internal" href="#get-and-set-values-for-rows">Get and Set Values for Rows</a></li>
<li><a class="reference internal" href="#get-and-set-values-for-list-likes">Get and Set Values for List-Likes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#create-new-values">Create New Values</a><ul>
<li><a class="reference internal" href="#create-new-list-likes">Create New List-Likes</a></li>
<li><a class="reference internal" href="#create-new-rows">Create New Rows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#delete-items">Delete Items</a></li>
</ul>
</li>
<li><a class="reference internal" href="#printing-an-ndf-code-out">Printing an NDF Code Out</a></li>
<li><a class="reference internal" href="#general-recommendations-and-caveats">General Recommendations and Caveats</a><ul>
<li><a class="reference internal" href="#errors-suppression">Errors Suppression</a></li>
<li><a class="reference internal" href="#nested-edits">Nested Edits</a></li>
<li><a class="reference internal" href="#syntax-checking-strictness">Syntax Checking Strictness</a></li>
<li><a class="reference internal" href="#source-is-a-list-but-it-s-not">Source Is a List But It’s Not</a></li>
<li><a class="reference internal" href="#path-relativeness">Path Relativeness</a></li>
<li><a class="reference internal" href="#typing-ambiguity">Typing Ambiguity</a></li>
<li><a class="reference internal" href="#no-referencing">No Referencing</a></li>
<li><a class="reference internal" href="#strict-attributes-in-edits">Strict Attributes in Edits</a></li>
<li><a class="reference internal" href="#comparing-strings">Comparing Strings</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=63c56aed"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>